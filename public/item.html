<html>
<head>
    <title>清晨好文章</title>
    <meta charset="UTF-8">
    <meta name="description" content="">
    <meta name="MobileOptimized">
    <meta name="viewport" content="width=640,user-scalable=no">
    <meta http-equiv="cleartype" content="on">
    <link rel="stylesheet" href="css/resest.css"/>
    <link rel="stylesheet" href="css/article.css"/>
</head>
<body>
<div class="page item">
    <div class="container">

        <div class="post-inner">
            <h1 class="name post-title entry-title" itemprop="itemReviewed" itemscope="">
                <span itemprop="name" id="name"></span>
            </h1>

            <div class="clear"></div>

            <div class="entry">
                <p id="author"></p>
                <!--内容-->
                <div id="article_text"></div>
            </div>
            <!-- .entry /-->


        </div>
        <div class="random_box">
            <a id="random" class="random_article" href="javascript:void(0)">随机文章</a>
        </div>
    </div>
    <a href="../index.html" class="goback"><img src="img/Arrow-Left.png" alt="返回"/></a>

    <!-- 多说评论框 start -->
    <div class="ds-thread" data-thread-key="" data-title="" data-url=""></div>
    <!-- 多说评论框 end -->
    <!-- 多说公共JS代码 start (一个网页只需插入一次) -->
    <script type="text/javascript">
        var duoshuoQuery = {short_name: "raclen2"};
        (function () {
            var ds = document.createElement('script');
            ds.type = 'text/javascript';
            ds.async = true;
            ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
            ds.charset = 'UTF-8';
            (document.getElementsByTagName('head')[0]
            || document.getElementsByTagName('body')[0]).appendChild(ds);
        })();
    </script>
    <!-- 多说公共JS代码 end -->
</div>

<script src="//www.wanlitong.com/app_js/wanlitong/v40/wap/vendor/zepto/dist/zepto.min.js"></script>
<script>
    var item = {
        tools: {
            params: function (uri) {
                var ret = {},
                        seg = uri.substring(uri.indexOf('?') + 1, uri.length).split('&'),
                        len = seg.length, i = 0, s;
                for (; i < len; i++) {
                    if (!seg[i]) {
                        continue;
                    }
                    s = seg[i].split('=');
                    ret[s[0]] = s[1];
                }
                return ret;
            }
        },
        init: function () {
            var _this = this;
            var resparams = this.tools.params(window.location.href);
            //文章ID
            var article = resparams.article;
            var categoryid = resparams.categoryid;
            var articleid = resparams.articleid;
            this.section = $('<section class="mod model-3"> <div class="spinner liu"> </div> </section>');
            this.getwenzhang(article, categoryid, articleid);
            $('#random').on('click', function () {
                _this.getwenzhang('', '003');
            })
        },
        getwenzhang: function (a, c, id) {
            var _this = this;
            //var baseUrl = '';
            var baseUrl='http://raclen-wenzhang.coding.io';
            $.ajax({
                url: baseUrl + '/contents',
                type: 'GET',
                data: {
                    article: a,
                    categoryid: c,
                    articleid: id
                },
                dataType: 'jsonp',
                beforeSend: function () {
                    $('body').prepend(_this.section);
                },
                success: function (data) {
                    //console.log(data)
                    if (data.statusCode !== '0000') {
                        alert(data.message);
                        return;
                    }
                    _this.section.remove();
                    $('#name').text(data.titile)
                    $('#author').text(data.author);
                    $('#article_text').html(data.content);
                    document.body.scrollTop = 0;
                    //多说配置encodeURIComponent(data.titile)
                    var $ds = $('.ds-thread');
                    $ds.attr('data-thread-key', encodeURIComponent(data.titile));
                    $ds.attr('data-title', data.titile);
                    $ds.attr('data-url', window.location.href);


                }
            })

        }

    }
    item.init();
    $(window).scroll(function () {
        var scrollTop = $(this).scrollTop();
        var scrollHeight = $(document).height();
        var windowHeight = $(this).height();
        if (scrollTop + windowHeight+20 >=scrollHeight) {
            $('.goback').hide();
        }
        else{
            $('.goback').show();
        }
    });

</script>
</body>
</html>
